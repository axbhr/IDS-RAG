documents:
  # === THREAT DEFINITIONS (MACHINE-READABLE) ===
  
  - type: text
    content: |
      === DATA EXFILTRATION ===
      ID: data_exfiltration
      SEVERITY: Critical
      CONDITION_1: orig_bytes > resp_bytes
      CONDITION_2: orig_bytes >= 1000000
      CONDITION_3: duration_seconds >= 10
      CONDITION_4: conn_state = SF
      ALL_CONDITIONS_REQUIRED: YES
      MATCH_EXAMPLE: orig_bytes=5000000 | resp_bytes=500 | duration_seconds=300 | conn_state=SF → THREAT
      NO_MATCH_EXAMPLE: orig_bytes=150 | resp_bytes=3000 | duration_seconds=0.5 | conn_state=SF → NOT A THREAT
    metadata:
      threat_id: "data_exfiltration"
      severity: "Critical"

  - type: text
    content: |
      === SSH BRUTE FORCE ===
      ID: ssh_brute_force
      SEVERITY: High
      CONDITION_1: dst_port = 22
      CONDITION_2: conn_state = S0 OR conn_state = REJ
      CONDITION_3: duration_seconds < 1
      CONDITION_4: orig_bytes = 0 OR orig_bytes < 100
      ALL_CONDITIONS_REQUIRED: YES
      MATCH_EXAMPLE: dst_port=22 | conn_state=S0 | duration_seconds=0.01 | orig_bytes=0 → THREAT
      NO_MATCH_EXAMPLE: dst_port=443 | conn_state=SF | duration_seconds=300 → NOT A THREAT
    metadata:
      threat_id: "ssh_brute_force"
      severity: "High"

  - type: text
    content: |
      === TCP PORT SCANNING ===
      ID: port_scanning
      SEVERITY: Medium
      CONDITION_1: conn_state EQUALS S0 OR conn_state EQUALS REJ
      CONDITION_2: Multiple connections from same source to different dst_port
      CONDITION_3: conn_state NOT_EQUALS SF
      ALL_CONDITIONS_REQUIRED: YES
      MATCH_EXAMPLE: S0 to dst_port 20,21,22,80,443 within 60s → THREAT
      NO_MATCH_EXAMPLE: SF to single dst_port 443 with high bytes → NOT A THREAT
    metadata:
      threat_id: "port_scanning"
      severity: "Medium"
